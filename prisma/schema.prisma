generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Admin {
  id                  String        @id @default(uuid())
  name                String
  email               String        @unique
  passwordHash        String
  resetToken          String?
  tokenExpiry         DateTime?
  role                Role          @default(ADMIN)
  createdAt           DateTime      @default(now())
  updatedAt           DateTime      @updatedAt
}

model Client {
  id                  String        @id @default(uuid())
  name                String
  email               String        @unique
  address             String?
  phone               String?
  orders              Order[]
  createdAt           DateTime      @default(now())
}

model Product {
  id                  Int           @id @default(autoincrement())
  name                String
  description         String?
  price               Float
  stock               Int
  sku                 String?       @unique
  orders              OrderItem[]
  createdAt           DateTime      @default(now())
}

model Order {
  id                  Int           @id @default(autoincrement())
  client              Client        @relation(fields: [clientId], references: [id])
  clientId            String
  items               OrderItem[]
  total               Float
  status              OrderStatus   @default(PENDING)
  createdAt           DateTime      @default(now())
  updatedAt           DateTime      @updatedAt
}

model OrderItem {
  id                  Int           @id @default(autoincrement())
  order               Order         @relation(fields: [orderId], references: [id])
  orderId             Int
  product             Product       @relation(fields: [productId], references: [id])
  productId           Int
  quantity            Int
  priceAtPurchase     Float
}

enum Role {
  ADMIN
  MANAGER
}

enum OrderStatus {
  PENDING
  PROCESSING
  SHIPPED
  DELIVERED
  CANCELLED
}